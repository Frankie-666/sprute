1. move query to the socket connection +
